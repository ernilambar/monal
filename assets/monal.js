(()=>{"use strict";(function(n){var t={install_plugins:function(n){(new o).init(n)},install_content:function(n){(new i).init(n)}};function e(){var e=n(".monal__body"),o=(n(".monal__body--loading"),n(".monal__body--exiting"),n("#monal__drawer-trigger")),i="monal__drawer--open";setTimeout((function(){e.addClass("loaded")}),100),o.on("click",(function(){e.toggleClass(i)})),n(".monal__button--proceed:not(.monal__button--closer)").on("click",(function(n){n.preventDefault();var t=this.getAttribute("href");e.addClass("exiting"),setTimeout((function(){window.location=t}),400)})),n(".monal__button--closer").on("click",(function(n){e.removeClass(i),n.preventDefault();var t=this.getAttribute("href");setTimeout((function(){e.addClass("exiting")}),600),setTimeout((function(){window.location=t}),1100)})),n(".button-next").on("click",(function(e){if(e.preventDefault(),"yes"==(o=jQuery(this)).data("done-loading")||(o.is("input")||o.is("button"),o.data("done-loading","yes"),o.addClass("monal__button--loading"),0))return!1;var o,i=n(this).data("callback");return!i||void 0===t[i]||(t[i](this),!1)})),n(document).on("change",".js-monal-demo-import-select",(function(){var t=n(this).val(),e=MONAL_LOCALIZED.base_url+"/assets/img/no-preview.png",o=MONAL_LOCALIZED.import_files[t].import_preview_image_url;void 0!==o&&""!==o||(o=e),n(".js-content-preview-billboard").find("img").attr("src",o),n(".js-monal-select-spinner").show(),n.post(MONAL_LOCALIZED.ajaxurl,{action:"monal_update_selected_import_data_info",wpnonce:MONAL_LOCALIZED.wpnonce,selected_index:t},(function(t){t.success?n(".js-monal-drawer-import-content").html(t.data):alert(MONAL_LOCALIZED.texts.something_went_wrong),n(".js-monal-select-spinner").hide()})).fail((function(){n(".js-monal-select-spinner").hide(),alert(MONAL_LOCALIZED.texts.something_went_wrong)}))}))}function o(){var t,e,o=n(".monal__body"),i=0,a="",s="";function l(n){var t=e.find("label");"object"==typeof n&&void 0!==n.message?(t.removeClass("installing success error").addClass(n.message.toLowerCase()),void 0!==n.done&&n.done?d():void 0!==n.url?n.hash==s?(t.removeClass("installing success").addClass("error"),d()):(s=n.hash,jQuery.post(n.url,n,l).fail(l)):d()):r()}function r(){a&&(e.find("input:checkbox").is(":checked")?jQuery.post(MONAL_LOCALIZED.ajaxurl,{action:"monal_plugins",wpnonce:MONAL_LOCALIZED.wpnonce,slug:a},l).fail(l):(e.addClass("skipping"),setTimeout(d,300)))}function d(){e&&(e.data("done_item")||(i++,e.data("done_item",1)),e.find(".spinner").css("visibility","hidden"));var o=n(".monal__drawer--install-plugins li");o.each((function(){var t=n(this);return!!t.data("done_item")||(a=t.data("slug"),e=t,r(),!1)})),i>=o.length&&t()}return{init:function(e){n(".monal__drawer--install-plugins").addClass("installing"),n(".monal__drawer--install-plugins").find("input").prop("disabled",!0),t=function(){setTimeout((function(){n(".monal__body").addClass("js--finished")}),1e3),o.removeClass("monal__drawer--open"),setTimeout((function(){n(".monal__body").addClass("exiting")}),3e3),setTimeout((function(){window.location.href=e.href}),3500)},d()}}}function i(){var t,e,o,i=n(".monal__body"),a=0,s="",l="",r=1,d=0;function c(t){var o=e.find("label");"object"==typeof t&&void 0!==t.message?(o.addClass(t.message.toLowerCase()),void 0!==t.num_of_imported_posts&&0<d&&(r="all"===t.num_of_imported_posts?d:t.num_of_imported_posts,_()),void 0!==t.url?t.hash===l?(o.addClass("status--failed"),u()):(l=t.hash,void 0===t.selected_index&&(t.selected_index=n(".js-monal-demo-import-select").val()||0),jQuery.post(t.url,t,c).fail(c)):(t.done,u())):(console.log(t),o.addClass("status--error"),u())}function u(){var o=!1;e&&(e.data("done_item")||(a++,e.data("done_item",1)),e.find(".spinner").css("visibility","hidden"));var i=n(".monal__drawer--import-content__list-item");n(".monal__drawer--import-content__list-item input:checked"),i.each((function(){""==s||o?(s=n(this).data("content"),e=n(this),s&&(e.find("input:checkbox").is(":checked")?jQuery.post(MONAL_LOCALIZED.ajaxurl,{action:"monal_content",wpnonce:MONAL_LOCALIZED.wpnonce,content:s,selected_index:n(".js-monal-demo-import-select").val()||0},c).fail(c):(e.addClass("skipping"),setTimeout(u,300))),o=!1):n(this).data("content")==s&&(o=!0)})),a>=i.length&&t()}function _(){n(".js-monal-progress-bar").css("width",r/d*100+"%");var t,e=(t=r/d*100,0,99,Math.min(99,Math.max(0,t)));n(".js-monal-progress-bar-percentage").html(Math.round(e)+"%"),1==r/d&&clearInterval(o)}return{init:function(e){n(".monal__drawer--import-content").addClass("installing"),n(".monal__drawer--import-content").find("input").prop("disabled",!0),t=function(){n.post(MONAL_LOCALIZED.ajaxurl,{action:"monal_import_finished",wpnonce:MONAL_LOCALIZED.wpnonce,selected_index:n(".js-monal-demo-import-select").val()||0}),setTimeout((function(){n(".js-monal-progress-bar-percentage").html("100%")}),100),setTimeout((function(){i.removeClass("monal__drawer--open")}),500),setTimeout((function(){n(".monal__body").addClass("js--finished")}),1500),setTimeout((function(){n(".monal__body").addClass("exiting")}),3400),setTimeout((function(){window.location.href=e.href}),4e3)},function(){if(!n(".monal__drawer--import-content__list-item .checkbox-content").is(":checked"))return!1;jQuery.post(MONAL_LOCALIZED.ajaxurl,{action:"monal_get_total_content_import_items",wpnonce:MONAL_LOCALIZED.wpnonce,selected_index:n(".js-monal-demo-import-select").val()||0},(function(n){0<(d=n.data)&&(_(),o=setInterval((function(){r+=d/500,_()}),1e3))}))}(),u()}}}return{init:function(){n(e)},callback:function(n){console.log(n),console.log(this)}}})(jQuery).init()})();